<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Content Manager</title>
</head>
<body>
  <link rel="preload" href="https://fonts.gstatic.com/s/nunito/v16/XRXW3I6Li01BKofAnsSUYevIWzgPDA.woff2" as="font"
    type="font/woff2" crossorigin />
  <link rel="preload" href="https://fonts.gstatic.com/s/nunito/v16/XRXV3I6Li01BKofINeaBTMnFcQ.woff2" as="font"
    type="font/woff2" crossorigin />
  <script src="https://unpkg.com/netlify-cms@2.10.192/dist/netlify-cms.js"></script>
  <script>
    CMS.registerPreviewStyle("/admin/base-preview.css");
    CMS.registerPreviewStyle("/admin/news-preview.css");

    const NewsPreview = createClass({
      render: function () {
        const { entry, widgetFor, getAsset } = this.props;
        const slug = window.location.hash.replace('#/collections/news/entries/', '').replace('/index', '');
        const authorId = entry.getIn(['data', 'author']) || 'mklein';
        const title = entry.getIn(['data', 'title']);
        const categories = (entry.getIn(['data', 'categories']) || []);
        const publishDate = entry.getIn(['data', 'publishDate']) || new Date();
        const coverImage = entry.getIn(['data', 'cover']) || '';
        const coverImageUrl = coverImage.includes('/') ? getAsset(coverImage) : `/news/${slug}/${coverImage}`;

        return h('div', { className: 'main single' },
          h('article', {},
            h('div', { className: 'layout horizontal' },
              h('div', { className: 'stretch article-categories' }, categories.map((category) => h('div', {}, category))),
              h('div', { className: 'article-date'}, publishDate.toLocaleDateString("de-DE", { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }))
            ),
            h('div', { className: 'layout horizontal heading' },
              h('h1', { className: 'stretch' }, title),
              h('div', { className: 'layout horizontal center-aligning article-author' },
                h('img', { src: `/staff/${authorId}.png`, className: 'article-author-image' }),
                h('div', { className: 'stretch' },
                  h('div', { className: 'article-author-name' }, 'Martin Kleinschrodt'),
                  h('div', { className: 'article-author-title' }, 'Produktentwicklung')
                )
              )
            ),
            h('div', { className: 'article-cover-wrapper' },
              h('img', { src: coverImageUrl, className: 'article-cover' })
            ),
            h('div', { className: 'article-content' }, widgetFor('body')),
          )
        );
      }
    });

    CMS.registerPreviewTemplate("news", NewsPreview);
  </script>
  <script src="https://kit.fontawesome.com/b11eabbb32.js" crossorigin="anonymous" async></script>
</body>
</html>
